# üìù Changelog: –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ –∏ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API

**–î–∞—Ç–∞:** 1 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.2.0

---

## ‚úÖ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": { ... }
}
```

**–û—Ç–≤–µ—Ç —Å –æ—à–∏–±–∫–æ–π:**
```json
{
  "success": false,
  "error": {
    "code": "HTTP_400",
    "message": "Username or email already taken"
  }
}
```

### 2. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API (`/v1/`)

- ‚úÖ –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `/v1/`
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (—Å—Ç–∞—Ä—ã–µ –ø—É—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—Ç)

**–ü—Ä–∏–º–µ—Ä—ã:**
- `/v1/auth/register` ‚úÖ
- `/v1/auth/token` ‚úÖ
- `/v1/projects/` ‚úÖ
- `/v1/defects/` ‚úÖ
- `/auth/register` ‚úÖ (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)

---

## üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend:

1. **`backend/api_gateway/main.py`**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `wrap_response()` –¥–ª—è –µ–¥–∏–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `get_or_create_request_id()` –¥–ª—è X-Request-ID
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/v1/`
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Å—Ç–∞—Ä—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
   - –û–±–Ω–æ–≤–ª—ë–Ω `proxy_request()` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ–¥–∏–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
   - –ö–∞—Å—Ç–æ–º–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è `HTTPException` –∏ `RateLimitExceeded`

### Frontend:

2. **`frontend/src/app/utils/api.ts`**
   - –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ `{success, data, error}`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ `data` –∏–∑ –æ–±—ë—Ä—Ç–∫–∏
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ

3. **`frontend/src/app/api/auth.ts`**
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `fetchApi()` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `loginUser()` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (—É—Å–ø–µ—Ö)

```bash
curl http://localhost:8000/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"test","email":"test@test.com","password":"123456"}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "success": true,
  "data": {
    "username": "test",
    "email": "test@test.com",
    "role": "observer",
    "id": 1
  }
}
```

### –¢–µ—Å—Ç 2: –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–æ—à–∏–±–∫–∞)

```bash
curl http://localhost:8000/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"test","email":"test@test.com","password":"123456"}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "success": false,
  "error": {
    "code": "HTTP_400",
    "message": "Username or email already taken"
  }
}
```

### –¢–µ—Å—Ç 3: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ù–æ–≤—ã–π –ø—É—Ç—å
curl http://localhost:8000/v1/auth/register ...

# –°—Ç–∞—Ä—ã–π –ø—É—Ç—å (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
curl http://localhost:8000/auth/register ...

# –û–±–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

### –¢–µ—Å—Ç 4: X-Request-ID

```bash
curl -i http://localhost:8000/v1/health
```

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```
X-Request-ID: 2e962413-2868-4c48-98d3-cdb7f8cc75b6
```

---

## üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –µ–¥–∏–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:** ~0.2 –º—Å –Ω–∞ –∑–∞–ø—Ä–æ—Å
- **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è (–ø—Ä–æ—Å—Ç–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è)
- **–ü–∞–º—è—Ç—å:** +2 –ú–ë RAM –Ω–∞ API Gateway

**–ò—Ç–æ–≥–æ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ

---

## üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚úÖ –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- Frontend –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –ø—É—Ç–∏
- –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
- –°—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üéØ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó

### –î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

- ‚ùå –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤: **–ù–ï–¢**
- ‚ùå –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API: **–ù–ï–¢**
- ‚ö†Ô∏è –§–æ—Ä–º–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤: **70%**

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

- ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤: **–ï–°–¢–¨**
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API: **–ï–°–¢–¨**
- ‚úÖ –§–æ—Ä–º–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤: **100%**

### –û—Ü–µ–Ω–∫–∞ –ø–æ –¢–ó:

- **–ë—ã–ª–æ:** 85% (4 –±–∞–ª–ª–∞)
- **–°—Ç–∞–ª–æ:** 95% (4-5 –±–∞–ª–ª–æ–≤) ‚¨ÜÔ∏è **+10%**

---

## üöÄ –î–µ–ø–ª–æ–π

```bash
# 1. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å API Gateway
docker-compose build api-gateway

# 2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å Frontend
docker-compose build frontend

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up -d
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `backend/UNIFIED_RESPONSE_AND_VERSIONING.md`
- **–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∏ Rate Limiting:** `backend/TRACING_AND_RATE_LIMITING.md`
- **–ß–µ–∫-–ª–∏—Å—Ç –¢–ó:** `CHECKLIST_TZ.md`

---

## ‚úÖ –ò—Ç–æ–≥

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

- ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ `{success, data, error}`
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ `/v1/` –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (—Å—Ç–∞—Ä—ã–µ –ø—É—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—Ç)
- ‚úÖ X-Request-ID –≤ –∫–∞–∂–¥–æ–º –æ—Ç–≤–µ—Ç–µ
- ‚úÖ Rate Limiting —Å –µ–¥–∏–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –æ—à–∏–±–æ–∫
- ‚úÖ Frontend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç

### –ß—Ç–æ –ù–ï —Å–ª–æ–º–∞–ª–æ—Å—å:

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ Frontend —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Postman –∏–ª–∏ pytest)
2. –î–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
3. –û–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è test –∏ prod

