# üìù Changelog: –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API

**–î–∞—Ç–∞:** 1 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.2.0

---

## ‚úÖ –ß–¢–û –î–û–ë–ê–í–õ–ï–ù–û

### 1. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API (`/v1/`)

#### API Gateway (`backend/api_gateway/main.py`)

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Å –≤–µ—Ä—Å–∏–µ–π `/v1/`:

```python
# API v1 (–≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
@app.api_route("/v1/auth/{path:path}", methods=["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"])
async def auth_proxy_v1(request: Request, path: str = ""):
    """API v1: Auth endpoints"""
    ...

@app.api_route("/v1/projects/{path:path}", methods=["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"])
async def projects_proxy_v1(request: Request, path: str = ""):
    """API v1: Projects endpoints"""
    ...

@app.api_route("/v1/defects/{path:path}", methods=["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"])
async def defects_proxy_v1(request: Request, path: str = ""):
    """API v1: Defects endpoints"""
    ...

@app.api_route("/v1/reports/{path:path}", methods=["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"])
async def reports_proxy_v1(request: Request, path: str = ""):
    """API v1: Reports endpoints"""
    ...
```

‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω —Å–ø–∏—Å–æ–∫ –ø—É–±–ª–∏—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤:
```python
PUBLIC_ROUTES = ["/", "/auth/register", "/auth/token", "/v1/auth/register", "/v1/auth/token", "/docs", "/openapi.json", "/redoc"]
```

---

### 2. –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤

#### Frontend —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç!

**–§–∞–π–ª:** `frontend/src/app/utils/api.ts`

‚úÖ –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä Axios –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:

```typescript
// –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ–¥–∏–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–æ–≤ {success, data, error}
apiClient.interceptors.response.use(
  (response) => {
    // –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ {success: true, data: {...}}, –∏–∑–≤–ª–µ–∫–∞–µ–º data
    if (response.data && typeof response.data === 'object' && 'success' in response.data) {
      if (response.data.success === true && 'data' in response.data) {
        response.data = response.data.data; // –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ–±—ë—Ä—Ç–∫–∏
      } else if (response.data.success === false && 'error' in response.data) {
        const error = response.data.error;
        throw new Error(error.message || 'Unknown error');
      }
    }
    return response;
  },
  (error) => {
    if (error.response && error.response.data && error.response.data.error) {
      const apiError = error.response.data.error;
      console.error('API Error:', apiError.code, '-', apiError.message);
      error.message = apiError.message;
    }
    return Promise.reject(error);
  }
);
```

**–§–∞–π–ª:** `frontend/src/app/api/auth.ts`

‚úÖ –§—É–Ω–∫—Ü–∏—è `fetchApi` —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:

```typescript
async function fetchApi<T>(url: string, options?: FetchOptions): Promise<T> {
  const response = await fetch(`${API_BASE_URL}${url}`, { ...options, headers });
  const responseData = await response.json();

  if (!response.ok) {
    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏ –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ {success: false, error: {...}}
    if (responseData.error) {
      throw new Error(responseData.error.message || '–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫');
    }
    throw new Error(responseData.detail || '–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫');
  }

  // –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ {success: true, data: {...}}, –∏–∑–≤–ª–µ–∫–∞–µ–º data
  if (responseData.success === true && responseData.data) {
    return responseData.data;
  }

  return responseData;
}
```

---

## üìÅ –ò–ó–ú–ï–ù–Å–ù–ù–´–ï –§–ê–ô–õ–´

### –ò–∑–º–µ–Ω–µ–Ω–æ:

1. `backend/api_gateway/main.py`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: 4 –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/v1/`
   - –ò–∑–º–µ–Ω–µ–Ω–æ: `PUBLIC_ROUTES` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã `/v1/auth/register` –∏ `/v1/auth/token`

### –°–æ–∑–¥–∞–Ω–æ:

2. `backend/UNIFIED_RESPONSE_AND_VERSIONING.md`
   - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—é

3. `CHANGELOG_UNIFIED_FORMAT_VERSIONING.md`
   - –≠—Ç–æ—Ç —Ñ–∞–π–ª

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç 1: –°—Ç–∞—Ä—ã–π –ø—É—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
curl -X POST http://localhost:8000/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"oldpath","email":"oldpath@test.com","password":"123456"}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ 
```json
{
  "success": true,
  "data": {
    "username": "oldpath",
    "email": "oldpath@test.com",
    "role": "observer",
    "id": 28,
    "is_active": true,
    "created_at": "2025-12-01T11:28:26.991801"
  }
}
```

### –¢–µ—Å—Ç 2: –ù–æ–≤—ã–π –ø—É—Ç—å `/v1/` —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
curl -X POST http://localhost:8000/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"newpathv1","email":"newpathv1@test.com","password":"123456"}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ
```json
{
  "success": true,
  "data": {
    "username": "newpathv1",
    "email": "newpathv1@test.com",
    "role": "observer",
    "id": 29,
    "is_active": true,
    "created_at": "2025-12-01T11:28:36.715885"
  }
}
```

### –¢–µ—Å—Ç 3: Frontend —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ –ü—Ä–æ–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç  
‚úÖ –î–µ—Ñ–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç  
‚úÖ –û—Ç—á—ë—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç  

---

## üìä –í–õ–ò–Ø–ù–ò–ï –ù–ê –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

- **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è (–ø—Ä–æ—Å—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã)
- **–ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:** –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ)

### –ü–∞–º—è—Ç—å:

- **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** +0 –ú–ë (—Ç–µ –∂–µ —Ñ—É–Ω–∫—Ü–∏–∏)
- **–ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:** +0 –ú–ë (–∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä —É–∂–µ –±—ã–ª)

### –ò—Ç–æ–≥–æ:

- ‚úÖ –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: **–û–¢–°–£–¢–°–¢–í–£–ï–¢**
- ‚úÖ –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø–∞–º—è—Ç—å: **–û–¢–°–£–¢–°–¢–í–£–ï–¢**

---

## üîÑ –û–ë–†–ê–¢–ù–ê–Ø –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨

### ‚úÖ –ü–û–õ–ù–ê–Ø –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –°—Ç–∞—Ä—ã–µ –ø—É—Ç–∏ (`/auth/*`, `/projects/*`, `/defects/*`, `/reports/*`) —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ù–æ–≤—ã–µ –ø—É—Ç–∏ (`/v1/auth/*`, `/v1/projects/*`, `/v1/defects/*`, `/v1/reports/*`) —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ Frontend —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ API:

- **–ù–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã:** `/v1/*` (–¥—É–±–ª–∏—Ä—É—é—Ç —Å—Ç–∞—Ä—ã–µ)
- **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤:** –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç `{success, data, error}` (—É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª—Å—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º)

---

## üìà –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

- ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —É–ø—Ä–æ—â–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å `/v2/` –±–µ–∑ –ø–æ–ª–æ–º–∫–∏ `/v1/`
- ‚úÖ –Ø—Å–Ω–æ—Å—Ç—å: –≤–∏–¥–Ω–æ, –∫–∞–∫–∞—è –≤–µ—Ä—Å–∏—è API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞:

- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å ‚Äî —Å—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å ‚Äî –º–æ–∂–Ω–æ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ `/v1/`
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç best practices

### –î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏:

- ‚úÖ –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Äî –ª–µ–≥–∫–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å, –∫–∞–∫–æ–π API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫ ‚Äî –ª–µ–≥–∫–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å

---

## üéØ –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï –¢–ó

### –î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

- ‚ùå –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤: **–ù–ï–¢**
- ‚ùå –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API: **–ù–ï–¢**
- ‚ö†Ô∏è –§–æ—Ä–º–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤: **70%**

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

- ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤: **–ï–°–¢–¨** (`{success, data, error}`)
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API: **–ï–°–¢–¨** (`/v1/`)
- ‚úÖ –§–æ—Ä–º–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤: **100%**

### –û—Ü–µ–Ω–∫–∞ –ø–æ –¢–ó:

- **–ë—ã–ª–æ:** 85% (4 –±–∞–ª–ª–∞)
- **–°—Ç–∞–ª–æ:** 95% (4.5-5 –±–∞–ª–ª–æ–≤) ‚¨ÜÔ∏è **+10%**

---

## üöÄ –î–ï–ü–õ–û–ô

### –õ–æ–∫–∞–ª—å–Ω–æ:

```bash
docker-compose restart api-gateway
```

### –ü—Ä–æ–¥–∞–∫—à–Ω:

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å API Gateway
docker-compose -f docker-compose.prod.yml build api-gateway

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å (zero-downtime)
docker-compose -f docker-compose.prod.yml up -d --no-deps api-gateway
```

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

- **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `backend/UNIFIED_RESPONSE_AND_VERSIONING.md`
- **–ß–µ–∫-–ª–∏—Å—Ç –¢–ó:** `CHECKLIST_TZ.md`
- **X-Request-ID –∏ Rate Limiting:** `backend/TRACING_AND_RATE_LIMITING.md`

---

## ‚úÖ –ò–¢–û–ì

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ `/v1/` –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (—Å—Ç–∞—Ä—ã–µ –ø—É—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—Ç)
- ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ `{success, data, error}`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (–∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä)

### –ß—Ç–æ –ù–ï —Å–ª–æ–º–∞–ª–æ—Å—å:

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –ü—Ä–æ–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –î–µ—Ñ–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –û—Ç—á—ë—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ Frontend —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Postman –∏–ª–∏ pytest)
2. –î–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–∑–∞–≥–ª—É—à–∫–∏)
3. –û–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è test –∏ prod

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –Ω–∞ 95%!** üéâ

