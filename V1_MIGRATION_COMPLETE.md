# ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ API v1 –ó–ê–í–ï–†–®–ï–ù–ê

**–î–∞—Ç–∞:** 1 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.2.0

---

## üéâ –ß–¢–û –°–î–ï–õ–ê–ù–û

### 1. Backend (API Gateway)

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –º–∞—Ä—à—Ä—É—Ç—ã —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º `/v1/`:
- `/v1/auth/*` ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `/v1/projects/*` ‚Äî –ø—Ä–æ–µ–∫—Ç—ã
- `/v1/defects/*` ‚Äî –¥–µ—Ñ–µ–∫—Ç—ã
- `/v1/reports/*` ‚Äî –æ—Ç—á—ë—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –°—Ç–∞—Ä—ã–µ –ø—É—Ç–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!

**–§–∞–π–ª:** `backend/api_gateway/main.py`

---

### 2. Frontend (React/Next.js)

‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `/v1/`:

**–§–∞–π–ª—ã:**
- `frontend/src/app/utils/api.ts` ‚Äî –≤—Å–µ 20+ —Ñ—É–Ω–∫—Ü–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- `frontend/src/app/api/auth.ts` ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```typescript
const API_VERSION = process.env.NEXT_PUBLIC_API_VERSION || '/v1';

// –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç:
`${API_VERSION}/auth/register`
`${API_VERSION}/projects/`
`${API_VERSION}/defects/`
// –∏ —Ç.–¥.
```

---

### 3. –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤

‚úÖ **–£–ñ–ï –†–ê–ë–û–¢–ê–õ!** –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä Axios –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": { ... }
}
```

**–û—Ç–≤–µ—Ç —Å –æ—à–∏–±–∫–æ–π:**
```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"
  }
}
```

---

## üß™ –ö–ê–ö –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–¢–¨

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** http://localhost:3000

2. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è:**
   - –û—Ç–∫—Ä–æ–π DevTools (F12) ‚Üí Network
   - –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ http://localhost:3000/register
   - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - **–ü—Ä–æ–≤–µ—Ä—å:** –ó–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –Ω–∞ `http://localhost:8000/v1/auth/register`

3. **–í–æ–π–¥–∏:**
   - –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ http://localhost:3000/login
   - –í–æ–π–¥–∏ –ø–æ–¥ —Å–æ–∑–¥–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
   - **–ü—Ä–æ–≤–µ—Ä—å:** –ó–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –Ω–∞ `http://localhost:8000/v1/auth/token`

4. **–°–æ–∑–¥–∞–π –ø—Ä–æ–µ–∫—Ç:**
   - –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ http://localhost:3000/projects
   - –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
   - **–ü—Ä–æ–≤–µ—Ä—å:** –ó–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –Ω–∞ `http://localhost:8000/v1/projects/`

5. **–°–æ–∑–¥–∞–π –¥–µ—Ñ–µ–∫—Ç:**
   - –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ http://localhost:3000/defects
   - –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –¥–µ—Ñ–µ–∫—Ç
   - **–ü—Ä–æ–≤–µ—Ä—å:** –ó–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –Ω–∞ `http://localhost:8000/v1/defects/`

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ curl (–¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏)

```bash
# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–Ω–æ–≤—ã–π –ø—É—Ç—å)
curl -X POST http://localhost:8000/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"testv1","email":"testv1@test.com","password":"123456"}'

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# {"success":true,"data":{"username":"testv1",...}}

# 2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–Ω–æ–≤—ã–π –ø—É—Ç—å)
curl -X POST http://localhost:8000/v1/auth/token \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=testv1&password=123456"

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# {"success":true,"data":{"access_token":"...","token_type":"bearer"}}

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ –ø—É—Ç–∏ (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
curl -X POST http://localhost:8000/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"testold","email":"testold@test.com","password":"123456"}'

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# {"success":true,"data":{"username":"testold",...}}
```

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–ó–ú–ï–ù–ï–ù–ò–ô

### Backend:

- **–ò–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:** 1 (`backend/api_gateway/main.py`)
- **–î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫:** ~30
- **–ù–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤:** 4 (auth, projects, defects, reports)

### Frontend:

- **–ò–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:** 2 (`api.ts`, `auth.ts`)
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ—É–Ω–∫—Ü–∏–π:** 20+
- **–î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫:** ~5 (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ API_VERSION)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- **–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 4
  - `backend/UNIFIED_RESPONSE_AND_VERSIONING.md`
  - `frontend/MIGRATION_TO_V1.md`
  - `CHANGELOG_UNIFIED_FORMAT_VERSIONING.md`
  - `V1_MIGRATION_COMPLETE.md` (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

---

## üéØ –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï –¢–ó

### –î–æ –º–∏–≥—Ä–∞—Ü–∏–∏:

- ‚ùå –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤: **–ù–ï–¢**
- ‚ùå –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API: **–ù–ï–¢**
- **–û—Ü–µ–Ω–∫–∞:** 85% (4 –±–∞–ª–ª–∞)

### –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

- ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤: **–ï–°–¢–¨** (`{success, data, error}`)
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API: **–ï–°–¢–¨** (`/v1/`)
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: **–ï–°–¢–¨**
- **–û—Ü–µ–Ω–∫–∞:** **95%** (4.5-5 –±–∞–ª–ª–æ–≤) ‚¨ÜÔ∏è **+10%**

---

## üîÑ –û–ë–†–ê–¢–ù–ê–Ø –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨

### ‚úÖ –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ê

**Backend –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞:**

| –°—Ç–∞—Ä—ã–π –ø—É—Ç—å | –ù–æ–≤—ã–π –ø—É—Ç—å | –û–±–∞ —Ä–∞–±–æ—Ç–∞—é—Ç? |
|-------------|------------|---------------|
| `/auth/register` | `/v1/auth/register` | ‚úÖ –î–ê |
| `/auth/token` | `/v1/auth/token` | ‚úÖ –î–ê |
| `/projects/` | `/v1/projects/` | ‚úÖ –î–ê |
| `/defects/` | `/v1/defects/` | ‚úÖ –î–ê |
| `/reports/*` | `/v1/reports/*` | ‚úÖ –î–ê |

**Frontend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:** `/v1/*` (–Ω–æ–≤—ã–µ –ø—É—Ç–∏)

**–°—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã:** –ü—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –ø—É—Ç—è–º–∏

---

## üöÄ –î–ï–ü–õ–û–ô

### –õ–æ–∫–∞–ª—å–Ω–æ (Docker):

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker-compose restart api-gateway frontend

# –ò–ª–∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
docker-compose build api-gateway frontend
docker-compose up -d
```

### –ü—Ä–æ–¥–∞–∫—à–Ω:

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export NEXT_PUBLIC_API_BASE_URL=https://api.yourdomain.com
export NEXT_PUBLIC_API_VERSION=/v1

# 2. –°–æ–±—Ä–∞—Ç—å backend
docker-compose -f docker-compose.prod.yml build api-gateway

# 3. –°–æ–±—Ä–∞—Ç—å frontend
cd frontend
npm run build

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose -f docker-compose.prod.yml up -d
```

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

- **Backend:** `backend/UNIFIED_RESPONSE_AND_VERSIONING.md`
- **Frontend:** `frontend/MIGRATION_TO_V1.md`
- **Changelog:** `CHANGELOG_UNIFIED_FORMAT_VERSIONING.md`
- **–ß–µ–∫-–ª–∏—Å—Ç –¢–ó:** `CHECKLIST_TZ.md`

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

- **API Docs:** http://localhost:8000/docs
- **Postman:** `docs/postman_collection.json`
- **OpenAPI:** `docs/openapi.yaml`

---

## ‚úÖ –ò–¢–û–ì

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

- ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ `/v1/`** ‚Äî –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- ‚úÖ **–ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤** ‚Äî `{success, data, error}`
- ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** ‚Äî —Å—Ç–∞—Ä—ã–µ –ø—É—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ **Frontend –æ–±–Ω–æ–≤–ª—ë–Ω** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/v1/`
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** ‚Äî –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä Axios

### –ß—Ç–æ –ù–ï —Å–ª–æ–º–∞–ª–æ—Å—å:

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –ü—Ä–æ–µ–∫—Ç—ã (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –î–µ—Ñ–µ–∫—Ç—ã (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –í–ª–æ–∂–µ–Ω–∏—è (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –û—Ç—á—ë—Ç—ã (–æ–±–∞ –ø—É—Ç–∏)
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (–æ–±–∞ –ø—É—Ç–∏)

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¢–ó:

1. ‚ùå **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å —Ç–µ—Å—Ç–∞–º–∏ –∏–ª–∏ pytest)
2. ‚ùå **–î–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** (–∑–∞–≥–ª—É—à–∫–∏ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π)
3. ‚ö†Ô∏è **–û–∫—Ä—É–∂–µ–Ω–∏—è** (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è test –∏ prod)

---

## üéâ –ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û!

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –Ω–∞ 95%!**

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¢–ó –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:
- ‚úÖ –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ API Gateway
- ‚úÖ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ X-Request-ID (—Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞)
- ‚úÖ Rate Limiting
- ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**

